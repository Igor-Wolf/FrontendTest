<!DOCTYPE html>
<html>
<head>
    <title>Minha Landing Page</title>
</head>
<body>
    <h1>Bem-vindo à minha Landing Page!</h1>
    <p>Acesse nosso conteúdo incrível.</p>
    <script>
        // Captura a origem do visitante
        const referrer = document.referrer || 'Desconhecido';

        // Define um cookie com a origem do visitante
        document.cookie = `visitorSource=${referrer}; path=/; samesite=strict`;

        // Recupera o cookie
        const getCookie = (name) => {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        };

        const visitorSource = getCookie('visitorSource');

        // Faz uma requisição ao backend
        fetch('https://backend-test-sable.vercel.app/api/count', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
                'x-visitor-source': visitorSource // Ajuste para minúsculas para correspondência
            }
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Data received from backend:', data);
        })
        .catch(error => {
            console.error('There was a problem with the fetch operation:', error);
        });
    </script>
</body>
</html>
